
<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
<!-- ==== SECTION: HEAD ==== -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV-Report [24.06.26 Head of CRM Retention. Dmitrijs Šuļickis]</title>

<!-- ==== PART 2: STYLES ==== -->
<style>
:root 
{
--color-bg: #FFFFFF;
--color-bg-surface: #F2F2F7;
--color-title: #000000;
--color-text-main: #1C1C1E;
--color-text-muted: #6E6E73;
--color-accent: #007AFF;
--color-accent-a: rgba(0,122,255,0.35);
--color-badge-text: #111;
--color-badge-bg-danger: #FF3B30;
--color-badge-bg-weak: #FF9F94;
--color-badge-bg-average: #FFCC00;
--color-badge-bg-success: #188038;
--color-badge-bg-strong: #34A853;
--color-border: #D1D1D6;
--border-width: 1px;
}

[data-theme="dark"] 
{
--color-bg: #202124;
--color-bg-surface: #2D2E30;
--color-title: #E6D2AA;
--color-text-main: #E0E0E0;
--color-text-muted: #BDC1C6;
--color-accent: #8AB4F8;
--color-accent-a: rgba(138,180,248,0.35);
--color-badge-text: #202124;
--color-badge-bg-danger: #FF6666;
--color-badge-bg-weak: #F28B82;
--color-badge-bg-average: #FDD663;
--color-badge-bg-success: #188038;
--color-badge-bg-strong: #34A853;
--color-border: #3C4043;
--border-width: 1px;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--color-bg); color: var(--color-text-main); font-size: 16px; line-height: 1.5; }
.container { width: 95%; max-width: 1400px; margin: 0 auto; padding: 15px 0; }
.dashboard-layout { display: grid; grid-template-columns: 320px 1fr; gap: 30px; align-items: flex-start; }
.dashboard-sidebar { position: sticky; top: 80px; display: flex; flex-direction: column; gap: 20px; }
.dashboard-content { display: flex; flex-direction: column; gap: 20px; }
#controls-section { position: sticky; top: 0; z-index: 100; background: var(--color-bg); padding: 10px 0; border-bottom: var(--border-width) solid var(--color-border); }
#controls-section .container { padding: 0; }
.controls-panel { display: flex; gap: 0.75em; align-items: center; }
#header-title { font-size: 1.35em; font-weight: 600; color: var(--color-title); margin-right: auto; padding-right: 1em; white-space: nowrap; }
.control-btn { position: relative; background-color: var(--color-bg-surface); border: var(--border-width) solid var(--color-border); padding: 0; border-radius: 8px; color: var(--color-text-main); cursor: pointer; display: flex; align-items: center; justify-content: center; height: 44px; width: 44px; flex-shrink: 0; transition: all 0.2s ease; }
.control-btn:hover { border-color: var(--color-accent); color: var(--color-accent); }
.control-btn svg { width: 22px; height: 22px; pointer-events: none; }
#theme-switcher .icon-sun { display: block; } #theme-switcher .icon-moon { display: none; }
[data-theme="light"] #theme-switcher .icon-sun { display: none; } [data-theme="light"] #theme-switcher .icon-moon { display: block; }
.dropdown-wrapper { position: relative; }
.dropdown-menu { display: none; position: absolute; top: 110%; right: 0; background-color: var(--color-bg-surface); border: var(--border-width) solid var(--color-border); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 8px; z-index: 100; min-width: 220px; }
.dropdown-menu.is-open { display: block; }
.dropdown-menu a { display: block; padding: 10px 15px; text-decoration: none; color: var(--color-text-main); border-radius: 4px; }
.dropdown-menu a:hover { background-color: var(--color-bg); }
#email-dropdown .action-item { padding: 10px; }
#email-dropdown .email-input { width: 100%; padding: 8px 12px; border-radius: 6px; border: var(--border-width) solid var(--color-border); background-color: var(--color-bg); color: var(--color-text-main); font-size: 0.85em; }
#email-dropdown .btn-action { display: block; width: 100%; background-color: var(--color-accent); color: var(--color-badge-text); padding: 10px; border: none; border-radius: 6px; font-weight: 500; cursor: pointer; text-align: center; margin-top: 10px; text-decoration: none; }
.card { background-color: var(--color-bg-surface); border-radius: 12px; border: var(--border-width) solid var(--color-border); overflow: hidden; }
.card-header { display: flex; justify-content: space-between; align-items: center; gap: 15px; padding: 15px; border-bottom: var(--border-width) solid var(--color-border); }
.card-header h2 { font-size: 1.2em; font-weight: 600; margin: 0; display: flex; align-items: center; gap: 0.75em; color: var(--color-accent); flex-grow: 1; }
.card-header h2 svg { width: 1.2em; height: 1.2em; flex-shrink: 0; }
.card-header .category-weight { font-size: 0.95em; font-weight: 500; color: var(--color-text-main); }
.card-content { padding: 15px; background-color: var(--color-bg-surface); }
[data-section="candidate"], [data-section="assessment-summary"] { padding: 15px; }
[data-element="candidate-header"] { text-align: center; }
.autoscaled-line { white-space: nowrap; overflow: hidden; display: block; }
[data-element="position-title"] { font-size: 1.2em; font-weight: 600; color: var(--color-accent); padding-bottom: 10px; }
[data-element="candidate-name"] { font-size: 1.2em; font-weight: 600; color: var(--color-title); }
.candidate-meta-group { display: flex; justify-content: center; align-items: center; gap: 10px; color: var(--color-text-main); font-size: 1em; flex-wrap: nowrap; margin-top: 10px; }
.date-meta-group { margin-bottom: 15px; }
.date-display { display: inline-block; padding: 2px 8px; background-color: var(--color-bg); color: var(--color-text-muted); border-radius: 6px; font-size: 0.9em; font-family: 'SF Mono', 'Fira Code', monospace; }
.score-display { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-top: 1px solid var(--color-border); }
[data-section="assessment-summary"] .score-display:first-child { padding-top: 0; border-top: none; }
[data-section="assessment-summary"] h4 { padding-top: 15px; margin-top: 15px; border-top: 1px solid var(--color-border); color: var(--color-accent); text-align: center; }
.score-label, [data-section="assessment-summary"] h4 { font-size: 1.1em; font-weight: 600; }
.score-value { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 1.1em; font-weight: 600; padding: 4px 10px; border-radius: 8px; color: var(--color-badge-text); min-width: 120px; text-align: center; }
.score-value.color-badge-bg-weak { background-color: var(--color-badge-bg-weak); }
.score-value.color-badge-bg-average { background-color: var(--color-badge-bg-average); }
.score-value.color-badge-bg-success { background-color: var(--color-badge-bg-success); }
.score-value.color-badge-bg-strong { background-color: var(--color-badge-bg-strong); }
[data-element="score-value"] { min-width: 150px; }
[data-section="assessment-summary"] h4 { margin-bottom: 5px; }
[data-element="verification-list"] { list-style: none; font-size: 0.95em; display: flex; flex-direction: column; gap: 8px; background-color: var(--color-bg); padding: 10px; border-radius: 8px; border: var(--border-width) solid var(--color-border); margin-top:0; }
[data-element="verification-list"] li { display: flex; justify-content: space-between; }
[data-element="verification-list"] .risk-value { font-family: 'SF Mono', 'Fira Code', monospace; font-weight: 600; color: var(--color-badge-bg-success); }
.content-list { list-style: none; padding: 0; display: flex; flex-direction: column; gap: 15px; }
.content-block { background-color: var(--color-bg); border: var(--border-width) solid var(--color-border); border-radius: 8px; padding: 15px; }
.grid-2-col { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.section-divider { border: none; border-top: 1px solid var(--color-border); margin: 20px 0 0 0; padding: 0; }
[data-block="justification"] { border-left-color: var(--color-accent-a); }
[data-element="justification-title"] { color: var(--color-title); margin-bottom: 5px; font-size: 1.1em; font-weight: 600; }
.color-indicator { display: inline-block; margin-right: 8px; vertical-align: middle; font-size: 1.2em; font-weight: bold; color: var(--color-border); }
.color-indicator.color-badge-bg-weak { color: var(--color-badge-bg-weak); }
.color-indicator.color-badge-bg-average { color: var(--color-badge-bg-average); }
.color-indicator.color-badge-bg-success { color: var(--color-badge-bg-success); }
.color-indicator.color-badge-bg-strong { color: var(--color-badge-bg-strong); }
.summary-grid { margin-top: 15px; }
[data-element="competency-item"] { padding: 10px 10px; }
.competency-header { margin-bottom: 10px; }
.progress-display { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
.progress-bar-wrapper { flex-grow: 1; flex-basis: 70%; height: 6px; background-color: var(--color-border); border-radius: 3px; overflow: hidden; }
.progress-bar { height: 100%; border-radius: 3px; }
[data-element="competency-item"].color-badge-bg-success .progress-bar { background-color: var(--color-badge-bg-success); width: 97%; }
[data-element="competency-item"].color-badge-bg-average .progress-bar { background-color: var(--color-badge-bg-average); width: 60%; }
[data-element="competency-item"].color-badge-bg-weak .progress-bar { background-color: var(--color-badge-bg-weak); width: 10%; }
.item-weight { font-size: 0.9em; font-weight: 500; color: var(--color-text-main); flex-shrink: 0; }
[data-block*="step"], [data-block*="variation"], [data-block*="risk"], [data-block*="assessment"], [data-block="pros"], [data-block="risks"], [data-block="justification"] { border-left-width: 4px; border-style: solid;}
[data-block*="step"] { border-left-color: var(--color-accent-a); }
[data-block="pros"] { border-left-color: var(--color-badge-bg-success); } [data-block="risks"] { border-left-color: var(--color-badge-bg-danger); }
[data-block="assessment-value"].color-badge-bg-strong { border-left-color: var(--color-badge-bg-strong); }
[data-block="assessment-value"].color-badge-bg-average { border-left-color: var(--color-badge-bg-average); }
[data-block="assessment-value"].color-badge-bg-weak { border-left-color: var(--color-badge-bg-danger); }
[data-block="variation-success"] { border-left-color: var(--color-badge-bg-success); }
[data-block="variation-average"] { border-left-color: var(--color-badge-bg-average); }
[data-block="variation-danger"] { border-left-color: var(--color-badge-bg-danger); }
[data-block="risk-dynamic"] { border-left-color: var(--color-badge-bg-average); }
[data-block="risk-static"] { border-left-color: var(--color-accent-a); }
.text-accent-secondary { color: var(--color-title); }
.task-block-wrapper { display: grid; grid-template-columns: 1fr; gap: 20px; }
.task-header { display: flex; align-items: center; gap:15px; margin-bottom: 10px; }
.task-header h4 { margin: 0; flex-grow: 1; }
pre, .notes-textarea { background-color: var(--color-bg); padding: 10px; border-radius: 8px; border: var(--border-width) solid var(--color-border); white-space: pre-wrap; word-break: break-word; }
pre, .notes-textarea { font-family: 'SF Mono', 'Fira Code', monospace; }
pre#test-assignment-md, pre#evaluation-form-md { color: var(--color-text-main); font-size: 0.9em; }
.notes-textarea { width: 100%; min-height: 150px; font-size: 0.9em; color: var(--color-text-muted); resize: vertical; }
#scrollToTopBtn { position: fixed; bottom: 20px; right: 20px; z-index: 1000; opacity: 0; visibility: hidden; transform: translateY(20px); transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; }
#scrollToTopBtn.is-visible { opacity: 1; visibility: visible; transform: translateY(0); }
footer { text-align: center; margin-top: 1rem; padding: 1rem 0; color: var(--color-text-muted); font-size: 0.9em; }
footer p { margin: 0.25rem 0; }
footer .copyright { color: var(--color-accent); font-weight: bold; }
@media (max-width: 1024px) {
.dashboard-layout, .grid-2-col { grid-template-columns: 1fr; }
.dashboard-sidebar { position: static; }
}
@media print {
:root {
--color-bg: #FFFFFF;
--color-bg-surface: #FFF8EB;
--color-title: #000000;
--color-text-main: rgba(0, 0, 0, 0.9);
--color-text-muted: rgba(0, 0, 0, 0.8);
--color-accent: #007AFF;
--color-accent-a: rgba(0, 122, 255, 0.25);
--color-badge-text: #FFFFFF;
--color-badge-bg-danger: #FF3333;
--color-badge-bg-weak: #FF7777;
--color-badge-bg-average: #FFCC00;
--color-badge-bg-success: #188038;
--color-badge-bg-strong: #34A853;
--color-border: #D1D1D6;
--border-width: 1px;
}

#controls-section, footer, #scrollToTopBtn, .section-divider { display: none !important; }
.card, .content-block { page-break-inside: avoid; }
.dashboard-content > .card { page-break-before: auto; } 
html { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
@page { size: A4; margin: 16mm; }
* { animation: none !important; transition: none !important; box-shadow: none !important; }
.sticky, [style*="position: sticky"] { position: static !important; }
.card, .content-block { overflow: visible !important; word-break: break-word; overflow-wrap: anywhere; }
img, svg, video, canvas { max-width: 100% !important; height: auto !important; }
}
</style>
<!-- ==== END PART 2 ==== -->
</head>

<body>

<!-- ==== SECTION: HEADER & CONTROLS ==== -->
<header id="controls-section">
<div class="container">
<div class="controls-panel">
<!-- Element: Title -->
<h1 id="header-title">CV Report</h1>
<!-- Element: Section Selector -->
<div class="dropdown-wrapper">
<button id="section-selector-btn" class="control-btn" title="Перейти к секции" aria-haspopup="true" aria-expanded="false"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></button>
<div id="section-selector-dropdown" class="dropdown-menu" role="menu"></div>
</div>
<!-- Element: Save to PDF -->
<button id="save-pdf-btn" class="control-btn" title="Сохранить в PDF"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg></button>
<!-- Element: Send Email -->
<div class="dropdown-wrapper">
<button id="email-btn" class="control-btn" title="Отправить Email" aria-haspopup="true" aria-expanded="false"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></button>
<div id="email-dropdown" class="dropdown-menu">
<div class="action-item"><input type="email" id="recipient-email" class="email-input" placeholder="Email получателя"><button id="send-report-email" class="btn-action">Сформировать Email</button></div>
</div>
</div>
<!-- Element: Theme Switcher -->
<button id="theme-switcher" class="control-btn" title="Сменить тему"><svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg><svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button>
</div>
</div>
</header>
<!-- ==== END SECTION: HEADER & CONTROLS ==== -->

<!-- ==== SECTION: MAIN WRAPPER ==== -->
<main>
<div class="container">
<div class="dashboard-layout">

<!-- ==== COMPONENT: SIDEBAR ==== -->
<aside id="dashboard-sidebar" class="dashboard-sidebar">

<!-- Card: Candidate Info -->
<div data-section="candidate" class="card">
    <div data-element="candidate-header" data-gender="male">
        <div class="autoscaled-line"><div data-element="position-title"><span>Head of CRM/Retention</span></div></div>
        <div class="autoscaled-line date-meta-group"><span data-element="report-date-value" class="date-display">[2025.09.01]</span></div>
        <div class="autoscaled-line"><h2 data-element="candidate-name"><span data-element="candidate-firstname">Dmitrijs</span> <span data-element="candidate-lastname">Šuļickis</span></h2></div>
        <div class="autoscaled-line">
            <div class="candidate-meta-group">
                <span><span data-element="candidate-age">34 г. </span> <span data-element="candidate-location">Латвия</span></span>
            </div>
        </div>
    </div>
</div>
<!-- End Card: Candidate Info -->

<!-- Card: Assessment Summary -->
<div data-section="assessment-summary" class="card">
    <!-- Metric: Confidence -->
    <div class="score-display">
        <span class="score-label">Confidence</span>
        <span data-element="confidence-value" class="score-value"></span>
    </div>
    <!-- Metric: Pre-Grade -->
    <div class="score-display">
        <span class="score-label">Pre-Grade</span>
        <span data-element="grade-value" class="score-value"></span>
    </div>
    <!-- Metric: Score -->
    <div class="score-display">
        <span class="score-label">Score</span>
        <span data-element="score-value" class="score-value"></span>
    </div>
    <!-- Metric: Verification Points -->
    <h4>Verification Points</h4>
    <ul data-element="verification-list"></ul>
</div>
<!-- End Card: Assessment Summary -->

</aside>
<!-- ==== END COMPONENT: SIDEBAR ==== -->

<!-- ==== COMPONENT: MAIN CONTENT ==== -->
<section class="dashboard-content">

<!-- Card: Executive Summary -->
<div data-section="summary" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg> <span>Executive Summary</span></h2></div>
    <div class="card-content">
        <!-- Part 1: Final Verdict Value (Placeholder) -->
        <div data-block="assessment-value" class="content-block color-badge-bg-average">
            <p><strong><span class="text-accent-secondary">Ценность:</span></strong><br>Дмитрий представляет умеренную ценность для роли Head of CRM/Retention, обладая высоким потенциалом роста за счет сильных аналитических компетенций.</p>
        </div>
        <!-- Part 2: Integrated Pros & Risks Grid -->
        <div class="grid-2-col summary-grid">
            <div data-block="pros" class="content-block">
                <p><strong class="text-accent-secondary">Главный актив:</strong><br>Мощная аналитическая база (BI, SQL, A/B тесты) и доказанная способность влиять на ключевые бизнес-метрики (NGR, Active Users), что является фундаментом для data-driven CRM.</p>
                <hr style="margin: 10px 0; border: none; border-top: 1px solid var(--color-border);">
                <p><strong class="text-accent-secondary">Подтверждающие факты:</strong></p>
                <p>Опыт управления кампаниями, отмеченный наградой EGR "Best Campaign", демонстрирует понимание механик вовлечения игроков.</p>
                <p>Глубокое знание iGaming-индустрии и продукта, что позволяет быстро погрузиться в контекст и разрабатывать релевантные CRM-стратегии.</p>
            </div>
            <div data-block="risks" class="content-block">
                <p><strong class="text-accent-secondary">Основные риски:</strong></p>
                <p><b>Критический пробел:</b> Отсутствует прямой, подтвержденный опыт работы с CRM-стратегией (управление жизненным циклом клиента, LTV, churn).</p>
                <p><b>Технологический пробел:</b> В резюме не упомянуты ключевые CRM-платформы (Optimove, Braze, Salesforce Marketing Cloud и др.).</p>
                <p>Карьерный фокус кандидата был на продуктовом и коммерческом управлении, а не на прямых маркетинговых коммуникациях и удержании.</p>
                <hr style="margin: 10px 0; border: none; border-top: 1px solid var(--color-border);">
                <p><strong class="text-accent-secondary">Ключевое условие найма:</strong><br>Подтверждение на интервью способности быстро освоить CRM-инструменты и эффективно перенести свой аналитический опыт на задачи по удержанию клиентов.</p>
            </div>
        </div>
        <!-- Part 3: Detailed Justification -->
        <div data-block="justification" class="content-block" style="margin-top: 15px;">
            <h4 data-element="justification-title">Детализация Оценки</h4>
            <p><span class="color-indicator">➔</span> <strong>Verdict: </strong>Кандидат является сильным коммерческим лидером и аналитиком, но не профильным CRM-специалистом. Его сильные стороны (аналитика, работа с данными, понимание iGaming) критически важны для CRM, но отсутствие прямого опыта и знания инструментов создает существенный риск. Это "ставка" на высокий интеллект и способность быстро обучаться.</p>
            <p style="margin-top: 0.5em;"><span class="color-indicator">➔</span> <strong>Grade: </strong>Кандидат обладает опытом уровня Head, но из-за отсутствия профильной экспертизы в CRM, для данной роли его грейд оценивается как **Lead**. Он может возглавить направление, но ему потребуется время на освоение домена и, возможно, сильный CRM Manager в команде.</p>
            <p style="margin-top: 0.5em;"><span class="color-indicator">➔</span> <strong>Confidence: </strong>**High**. Резюме очень четко и прозрачно описывает опыт кандидата, что позволяет с высокой уверенностью определить как сильные стороны, так и существующие пробелы относительно требований вакансии.</p>
        </div>
    </div>
</div>
<!-- End Card: Executive Summary -->

<!-- Card: Hard Skills -->
<div id="hard-skills" data-section="hard-skills" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg> <span>Hard Skills</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Hard Skills -->

<!-- Card: Tech-Stack -->
<div id="tech-stack" data-section="tech-stack" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <span>Tech-Stack</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Tech-Stack -->

<!-- Card: Soft Skills -->
<div id="soft-skills" data-section="soft-skills" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg> <span>Soft Skills</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Soft Skills -->

<!-- Card: Add. Info -->
<div id="formal" data-section="formal" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="9" y1="15" x2="15" y2="15"></line></svg> <span>Add. Info</span></h2><span class="category-weight"></span></div>
    <div class="card-content"><ul class="content-list"></ul></div>
</div>
<!-- End Card: Add. Info -->

<!-- ==== SECTION: OPERATIONAL BLOCK ==== -->
<hr class="section-divider">

<!-- Card: Risk / Verification -->
<div id="doubts" data-section="doubts" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg> <span>Risk / Verification</span></h2></div>
    <div class="card-content"><ul class="question-list content-list"><li data-block="risk-dynamic" class="content-block"><p><strong class="text-accent-secondary">Верифицируемый Пункт (Динамический Риск):</strong><br>Прямой опыт в CRM/Retention не заявлен. Необходимо проверить, насколько его аналитические и коммерческие навыки переносимы на задачи управления жизненным циклом клиента.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Вопрос (Цель: "Докажи это"): </span>"Приведите, пожалуйста, пример из вашего опыта в Rank Interactive, где вы использовали сегментацию и анализ данных для повышения вовлеченности конкретной группы игроков, что в итоге привело к росту NGR."</p></li><li data-block="risk-dynamic" class="content-block"><p><strong class="text-accent-secondary">Верифицируемый Пункт (Динамический Риск):</strong><br>Отсутствие опыта работы с ключевыми CRM-платформами (Optimove, Braze, Salesforce и т.д.) является значительным пробелом.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Вопрос (Цель: "Докажи это"): </span>"С какими инструментами для автоматизации маркетинга и коммуникации с клиентами вы работали? Опишите ваш опыт изучения и внедрения нового сложного ПО в вашу работу."</p></li><li data-block="risk-static" class="content-block"><p><strong class="text-accent-secondary">Пункт для Исследования (Статический Факт):</strong><br>Карьерный трек показывает запланированный переход на позицию Marketing Business Consultant, что может говорить о смене мотивации с операционной работы на проектную.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Вопрос (Цель: "Объясни это"): </span>"Ваше резюме показывает недавний переход в консалтинг. Что вас мотивирует сейчас рассматривать позицию Head of CRM, требующую глубокого операционного погружения и долгосрочного развития направления?"</p></li></ul></div>
</div>
<!-- End Card: Risk / Verification -->

<!-- Card: Interview Plan -->
<div id="interview-plan" data-section="interview-plan" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg> <span>Interview Plan</span></h2></div>
    <div class="card-content"><ul class="plan-list content-list"><li data-block="interview-step-1" class="content-block"><strong class="text-accent-secondary">Этап 1: Verification (15 мин):</strong><br>Проверка переносимости навыков. 1) "Дмитрий, ваша самая сильная сторона — аналитика. Как бы вы применили этот навык для решения классической CRM-задачи — снижения оттока игроков на 30-й день?". 2) "Какие 3 ключевые метрики вы бы вывели на дашборд Head of CRM и почему?". 3) "Расскажите о вашем опыте с маркетинговыми кампаниями. Какова была ваша роль в разработке креатива и оффера, а не только в анализе результатов?".</li><li data-block="interview-step-2" class="content-block"><strong class="text-accent-secondary">Этап 2: Deep Dive (25 мин):</strong><br>Проверка CRM-мышления через кейс. "Представьте: LTV наших VIP-игроков упал на 15% за последний квартал. Опишите ваш пошаговый план: какие данные вы бы запросили, какие гипотезы выдвинули, и какие 2-3 тестовые кампании по удержанию запустили бы в первую очередь?".</li><li data-block="interview-step-3" class="content-block"><strong class="text-accent-secondary">Этап 3: Behavioral (10 мин):</strong><br>Оценка мотивации и стиля управления. 1) "Почему вы решили сменить фокус с продукта на CRM? Что вас привлекает в работе с удержанием клиентов?". 2) "Как вы будете выстраивать работу с продуктовой командой, чтобы обеспечить реализацию необходимых для CRM фичей?".</li></ul></div>
</div>
<!-- End Card: Interview Plan -->

<!-- Card: Test Assignment -->
<div id="test-assignment" data-section="test-assignment" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg> <span>Test Assignment</span></h2></div>
    <div class="card-content">
        <div class="task-block-wrapper grid-2-col">
            <div>
                <div class="task-header">
                    <h4><span class="text-accent-secondary">Бриф Задания</span></h4>
                    <button class="control-btn" id="download-task-md-btn" title="Скачать .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>
                </div>
                <pre id="test-assignment-md">## Задача: Разработать стратегию реактивации на 3 месяца.
Контекст: Наша компания — Tier-2 iGaming оператор. У нас есть сегмент из 10,000 игроков, которые сделали хотя бы один депозит, но были неактивны последние 90-180 дней.

Требования:
1. Предложить логику сегментации этой аудитории (например, по LTV, предпочитаемым играм, последней активности).
2. Разработать 2-3 варианта офферов для разных подсегментов.
3. Описать каналы коммуникации и цепочку касаний для одной из кампаний.
4. Определить ключевые KPI для оценки успеха всей стратегии реактивации.

Время выполнения: 2-3 часа
Формат: Документ (1-2 стр) или презентация (3-5 слайдов).</pre>
</div>
<div>
<div class="task-header">
<h4><span class="text-accent-secondary">Критерии Оценки</span></h4>
<button class="control-btn" id="download-evaluation-md-btn" title="Скачать .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button>
</div>
<pre id="evaluation-form-md">Критерий (1-5) | Комментарии
----------------|------------------------------------
Сегментация | Глубина и логика разделения аудитории.
Офферы и креатив | Релевантность и привлекательность предложений.
Data-driven подход | Опора на данные и четкие KPI для оценки.
Понимание LTV | Ориентация на долгосрочную ценность, а не на разовый FTD.</pre>
</div>
</div>
</div>
</div>
<!-- End Card: Test Assignment -->

<!-- Card: Variations -->
<div id="variations" data-section="variations" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 4H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="12" y1="9" x2="12" y2="15"></line><line x1="9" y1="12" x2="15" y2="12"></line></svg> <span>Variations</span></h2></div>
    <div class="card-content"><ul class="content-list"><li data-block="variation-success" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Успех.</strong><br>Кандидат убедительно демонстрирует, как его аналитический опыт напрямую решает задачи CRM, показывает сильное теоретическое понимание LTV/Churn и высокую мотивацию освоить новые инструменты.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Решение: </span>Готовить оффер. Риск оправдан высоким потенциалом.</p></li><li data-block="variation-average" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Частичное подтверждение.</strong><br>Кандидат силен в анализе данных, но слаб в стратегическом планировании коммуникаций и понимании клиентского пути. Не может четко сформулировать, как будет управлять жизненным циклом.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Решение: </span>Отклонить на роль Head of CRM. Рассмотреть на роль Head of BI / Commercial Analytics, если есть релевантная вакансия.</p></li><li data-block="variation-danger" class="content-block"><p><strong class="text-accent-secondary">Сценарий: Провал.</strong><br>Кандидат не может "переключиться" с продуктового мышления на клиентоцентричное. Не видит разницы между управлением продуктом и управлением отношениями с клиентами. Мотивация к изучению CRM низкая.</p><p style="margin-top: 0.75em;"><span class="text-accent-secondary">Решение: </span>Отклонить кандидатуру.</p></li></ul></div>
</div>
<!-- End Card: Variations -->

<!-- Card: Comments -->
<div id="comments" data-section="comments" class="card">
    <div class="card-header"><h2><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg> <span>Notes</span></h2><button class="control-btn" id="save-comments-md-btn" title="Скачать комментарии .md"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg></button></div>
    <div class="card-content"><textarea id="notes-textarea" class="notes-textarea" placeholder="Поле для заметок рекрутера..."></textarea></div>
</div>
<!-- End Card: Comments -->

</section>
<!-- ==== END COMPONENT: MAIN CONTENT ==== -->

</div>
</div>
</main>
<!-- ==== END SECTION: MAIN WRAPPER ==== -->

<!-- ==== SECTION: UTILITIES ==== -->
<button id="scrollToTopBtn" class="control-btn" title="Наверх"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg></button>
<!-- ==== END SECTION: UTILITIES ==== -->

<!-- ==== SECTION: FOOTER ==== -->
<footer>
<p>Generated by MAE ARHA</p> 
<p class="copyright">© 2025 McBile AI-Engine</p>
</footer>
<!-- ==== END SECTION: FOOTER ==== -->

<!-- ==== SECTION: DATA & LOGIC ==== -->

<!-- ==== Component: Candidate Data (JSON) ==== -->
<script id="candidate-data" type="application/json">
{
  "Head of CRM/Retention": {
    "grade": "Lead",
    "confidence": "High",
    "weights": {
      "hard-skills": 45,
      "soft-skills": 30,
      "tech-stack": 15,
      "formal": 10
    },
    "competencies": {
      "hard-skills": [
        { "name": "CRM/Retention Стратегия", "scoreClass": "color-badge-bg-average", "weight": 40, "justification": "Прямой опыт отсутствует. Косвенно подтверждается опытом в кампаниях, но требует глубокой верификации." },
        { "name": "Data-driven Decision Making", "scoreClass": "color-badge-bg-success", "weight": 30, "justification": "Фундаментальный навык, подтвержденный всей карьерой в BI и аналитике (KPI, A/B-тесты, сегментация)." },
        { "name": "Customer Lifecycle Management", "scoreClass": "color-badge-bg-average", "weight": 20, "justification": "Подразумевается в задачах по росту активных пользователей, но нет явного упоминания работы с LTV, Churn, Onboarding." },
        { "name": "Campaign Management & ROI", "scoreClass": "color-badge-bg-success", "weight": 10, "justification": "Подтверждено наградой EGR 'Best Campaign' и фокусом на 'ROI-positive outcomes' в коммерческих переговорах." }
      ],
      "tech-stack": [
        { "name": "CRM Платформы (Optimove, Braze etc.)", "scoreClass": "color-badge-bg-weak", "weight": 50, "justification": "Критически важный для роли опыт не упомянут в резюме. Основной технологический риск." },
        { "name": "BI Инструменты (Tableau, Power BI)", "scoreClass": "color-badge-bg-success", "weight": 30, "justification": "Подтвержденный многолетний опыт, крайне релевантный для аналитической части CRM." },
        { "name": "SQL и Data-платформы", "scoreClass": "color-badge-bg-success", "weight": 20, "justification": "Многократно упомянут как ключевой инструмент для анализа данных на протяжении карьеры." }
      ],
      "soft-skills": [
        { "name": "Лидерство и управление командой", "scoreClass": "color-badge-bg-success", "weight": 50, "justification": "Подтвержденный опыт руководства командами менеджеров и исполняющего обязанности руководителя BI." },
        { "name": "Коммуникация и работа со стейкхолдерами", "scoreClass": "color-badge-bg-success", "weight": 30, "justification": "Опыт работы с Tier-1 клиентами и C-level руководством (CEO, COO) в нескольких компаниях." },
        { "name": "Стратегическое мышление", "scoreClass": "color-badge-bg-average", "weight": 20, "justification": "Подразумевается должностями, но сам процесс и личный вклад в формирование долгосрочной стратегии не описан." }
      ],
      "formal": [
        { "name": "Уровень английского языка (C1)", "scoreClass": "color-badge-bg-success", "weight": 50, "justification": "Подтвержден опытом работы в международных компаниях и юрисдикциях (Мальта, Гибралтар)." },
        { "name": "iGaming Экспертиза", "scoreClass": "color-badge-bg-success", "weight": 40, "justification": "10+ лет релевантного опыта, что является значительным преимуществом." },
        { "name": "Структура и консистентность CV", "scoreClass": "color-badge-bg-success", "weight": 10, "justification": "Резюме отлично структурировано и ориентировано на конкретные, измеримые достижения." }
      ]
    }
  },
  "Default": { "grade": "[...]" }
}
</script>
<!-- ==== End Component: Candidate Data (JSON) ==== -->

<!-- ==== SCRIPT: MAIN APPLICATION LOGIC ==== -->
<script>
// Encapsulate the entire application logic to avoid polluting the global namespace.
const HiringCoPilotApp = {
    // ==== 1. CONFIG & CONSTANTS ====
    config: {
        SCORE_MAP: { "color-badge-bg-success": 1.0, "color-badge-bg-average": 0.6, "color-badge-bg-weak": 0.1 },
        THEME_STORAGE_KEY: 'arhaTheme',
        NOTES_STORAGE_KEY: 'arhaNotes',
        DEFAULT_THEME: 'dark',
        FIXED_VERIFICATION_IMPACT: 5.0, // Fixed impact for Test Assignment verification
    },

    // ==== 2. DOM ELEMENTS ====
    dom: {},
    cacheDomElements() {
        const D = document;
        this.dom = {
            htmlElement: D.documentElement,
            themeSwitcher: D.getElementById('theme-switcher'),
            currentScoreEl: D.querySelector('[data-element="score-value"]'),
            verificationListEl: D.querySelector('[data-element="verification-list"]'),
            gradeValueDisplay: D.querySelector('[data-element="grade-value"]'),
            confidenceValueDisplay: D.querySelector('[data-element="confidence-value"]'),
            sectionSelectorBtn: D.getElementById('section-selector-btn'),
            sectionSelectorDropdown: D.getElementById('section-selector-dropdown'),
            emailBtn: D.getElementById('email-btn'),
            emailDropdown: D.getElementById('email-dropdown'),
            sendEmailBtn: D.getElementById('send-report-email'),
            emailInput: D.getElementById('recipient-email'),
            candidateHeader: D.querySelector('[data-element="candidate-header"]'),
            scrollToTopBtn: D.getElementById('scrollToTopBtn'),
            justificationBlock: D.querySelector('[data-block="justification"]'),
            savePdfBtn: D.getElementById('save-pdf-btn'),
            saveCommentsBtn: D.getElementById('save-comments-md-btn'),
            notesTextarea: D.getElementById('notes-textarea'),
            candidateDataScript: D.getElementById('candidate-data'),
            dashboardSidebar: D.querySelector('.dashboard-sidebar'), 
            summaryCard: D.querySelector('[data-section="summary"]'),
            reportDateValue: D.querySelector('[data-element="report-date-value"]'),
        };
    },

    // ==== 3. STATE & DATA ====
    state: { profile: null },
    loadData() {
        const rawData = this.dom.candidateDataScript.textContent;
        const candidateData = JSON.parse(rawData);
        const positionEl = document.querySelector('[data-element="position-title"] span');
        const positionText = positionEl ? positionEl.textContent.trim() : 'Default';
        this.state.profile = candidateData[positionText] || candidateData.Default;
    },

    // ==== 4. CORE LOGIC (CALCULATIONS) ====
    logic: {
        getScoreVerdict(score) {
            if (score < 60) return { verdict: 'Weak', class: 'color-badge-bg-weak' };
            if (score < 80) return { verdict: 'Average', class: 'color-badge-bg-average' };
            return { verdict: 'Strong', class: 'color-badge-bg-strong' };
        },
        calculateScores(profile) {
            const { SCORE_MAP, FIXED_VERIFICATION_IMPACT } = HiringCoPilotApp.config;
            if (!profile.weights || !profile.competencies) return { currentPercentage: 0, pointsToVerify: [] };

            let totalCurrentScore = 0;
            let dynamicPoints = [];

            for (const [sectionId, sectionWeight] of Object.entries(profile.weights)) {
                const items = profile.competencies[sectionId] || [];
                let sectionScore = 0;
                items.forEach(item => {
                    const currentScore = SCORE_MAP[item.scoreClass];
                    sectionScore += currentScore * (item.weight / 100);
                    if (item.scoreClass !== 'color-badge-bg-success') {
                        const scoreChangeDecimal = SCORE_MAP['color-badge-bg-success'] - currentScore;
                        const impact = scoreChangeDecimal * (item.weight / 100) * (sectionWeight / 100) * 100;
                        dynamicPoints.push({ name: item.name, impact });
                    }
                });
                totalCurrentScore += sectionScore * (sectionWeight / 100);
            }

            let currentPercentage = totalCurrentScore * 100;
            let totalDynamicImpact = dynamicPoints.reduce((sum, p) => sum + p.impact, 0);

            if (currentPercentage + FIXED_VERIFICATION_IMPACT + totalDynamicImpact > 100) {
                const overage = (currentPercentage + FIXED_VERIFICATION_IMPACT + totalDynamicImpact) - 100;
                const scalingFactor = (totalDynamicImpact > 0) ? Math.max(0, (totalDynamicImpact - overage) / totalDynamicImpact) : 0;
                dynamicPoints.forEach(p => { p.impact *= scalingFactor; });
            }
            
            const pointsToVerify = [{ name: "Верификация через ТЗ", impact: FIXED_VERIFICATION_IMPACT, isFixed: true }, ...dynamicPoints];
            return { currentPercentage, pointsToVerify };
        },
    },

    // ==== 5. RENDER FUNCTIONS ====
    render: {
        applyTheme(theme) {
            HiringCoPilotApp.dom.htmlElement.setAttribute('data-theme', theme);
            localStorage.setItem(HiringCoPilotApp.config.THEME_STORAGE_KEY, theme);
        },
        setReportDate() {
            const { dom } = HiringCoPilotApp;
            if (dom.reportDateValue) {
                const today = new Date();
                const formattedDate = today.toISOString().slice(0, 10).replace(/-/g, '.');
                dom.reportDateValue.textContent = `${formattedDate}`;
            }
        },
        competencyCards(profile) {
            if (!profile.weights || !profile.competencies) return;
            for (const [sectionId, items] of Object.entries(profile.competencies)) {
                const card = document.querySelector(`[data-section="${sectionId}"]`);
                if (!card) continue;
                
                const categoryWeight = profile.weights[sectionId] || 0;
                const weightEl = card.querySelector('.category-weight');
                if (weightEl) weightEl.textContent = `(${categoryWeight}%)`;
                
                const listEl = card.querySelector('.content-list');
                if (!listEl) continue;
                listEl.innerHTML = '';
                
                let fragment = document.createDocumentFragment();
                (items || []).forEach(item => {
                    const globalWeight = (item.weight * categoryWeight) / 100;
                    const li = document.createElement('li');
                    li.className = `content-block ${item.scoreClass}`;
                    li.setAttribute('data-element', 'competency-item');
                    li.innerHTML = `<div class="competency-header"><span class="competency-name">${item.name}</span></div><div class="progress-display"><div class="progress-bar-wrapper"><div class="progress-bar"></div></div><span class="item-weight">${item.weight}% (=&nbsp;${globalWeight.toFixed(0)}%)</span></div><p class="competency-justification" style="font-size: 0.9em; color: var(--color-text-muted);">${item.justification}</p>`;
                    fragment.appendChild(li);
                });
                listEl.appendChild(fragment);
            }
        },
        scores({ currentPercentage, pointsToVerify }, profile) {
            const { dom } = HiringCoPilotApp;
            const verdictInfo = HiringCoPilotApp.logic.getScoreVerdict(currentPercentage);

            if (dom.currentScoreEl) {
                dom.currentScoreEl.textContent = `${verdictInfo.verdict} (${currentPercentage.toFixed(1)}%)`;
                dom.currentScoreEl.className = 'score-value ' + verdictInfo.class;
            }
            
            if (dom.gradeValueDisplay && profile.grade) {
                const gradeText = profile.grade.toLowerCase();
                let gradeClass = 'color-badge-bg-average';
                if (gradeText.includes('head') || gradeText.includes('c-level')) gradeClass = 'color-badge-bg-strong';
                else if (gradeText.includes('senior') || gradeText.includes('lead')) gradeClass = 'color-badge-bg-success';
                else if (gradeText.includes('junior')) gradeClass = 'color-badge-bg-weak';
                dom.gradeValueDisplay.textContent = profile.grade;
                dom.gradeValueDisplay.className = 'score-value ' + gradeClass;
            }
            if (dom.confidenceValueDisplay && profile.confidence) {
                const confidenceText = profile.confidence.toLowerCase();
                let confidenceClass = 'color-badge-bg-average';
                if (confidenceText === 'high') confidenceClass = 'color-badge-bg-success';
                if (confidenceText === 'low') confidenceClass = 'color-badge-bg-weak';
                dom.confidenceValueDisplay.textContent = profile.confidence;
                dom.confidenceValueDisplay.className = 'score-value ' + confidenceClass;
            }

            if (dom.verificationListEl) {
                dom.verificationListEl.innerHTML = '';
                let fragment = document.createDocumentFragment();
                pointsToVerify.sort((a, b) => (b.isFixed ? 1 : 0) - (a.isFixed ? 1 : 0) || b.impact - a.impact).forEach(point => {
                    if (point.impact > 0.01) {
                        const li = document.createElement('li');
                        li.innerHTML = `<span>${point.name}</span> <span class="risk-value">+${point.impact.toFixed(1)}%</span>`;
                        fragment.appendChild(li);
                    }
                });
                if (fragment.children.length > 1) {
                    const secondItem = fragment.children[1];
                    secondItem.style.borderTop = '1px solid var(--color-border)';
                    secondItem.style.paddingTop = '8px';
                    secondItem.style.marginTop = '8px';
                }
                dom.verificationListEl.appendChild(fragment);
            }
            
            if(dom.justificationBlock) {
                const indicators = dom.justificationBlock.querySelectorAll('.color-indicator');
                if(indicators.length === 3) {
                    indicators[0].className = 'color-indicator ' + dom.currentScoreEl.classList[1];
                    indicators[1].className = 'color-indicator ' + dom.gradeValueDisplay.classList[1];
                    indicators[2].className = 'color-indicator ' + dom.confidenceValueDisplay.classList[1];
                }
            }
        },
    },
    
    // ==== 6. EVENT HANDLERS & UI HELPERS ====
    helpers: {
        autoScaleFont(containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            const lines = container.querySelectorAll('.autoscaled-line');
            const containerWidth = container.clientWidth;

            lines.forEach(line => {
                let element = line.firstElementChild;
                element.style.fontSize = ''; // Reset font size
                let baseFontSize = parseFloat(window.getComputedStyle(element).fontSize);
                
                if (element.scrollWidth > containerWidth) {
                    const scaleFactor = containerWidth / element.scrollWidth;
                    const newSize = Math.max(baseFontSize * scaleFactor, 9); // Minimum 9px font
                    element.style.fontSize = `${newSize}px`;
                }
            });
        },
        toggleDropdown(btn, menu) {
            const isOpen = menu.classList.toggle('is-open');
            if (btn) btn.setAttribute('aria-expanded', isOpen);
        },
        populateSectionSelector() {
            const dom = HiringCoPilotApp.dom;
            if (!dom.sectionSelectorDropdown) return;
            const sections = Array.from(document.querySelectorAll('.dashboard-content [data-section]')).map(card => ({
                id: card.id || card.dataset.section,
                title: card.querySelector('h2 > span')?.textContent.trim() || card.id
            }));
            dom.sectionSelectorDropdown.innerHTML = '';
            sections.forEach(s => {
                const a = document.createElement('a');
                a.href = `#${s.id}`;
                a.textContent = s.title;
                a.setAttribute('role', 'menuitem');
                a.onclick = (e) => {
                    e.preventDefault();
                    const targetElement = document.getElementById(s.id);
                    if (targetElement) targetElement.scrollIntoView({ behavior: 'smooth' });
                    HiringCoPilotApp.helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown);
                };
                dom.sectionSelectorDropdown.appendChild(a);
            });
        },
        downloadMarkdown(content, fileName) {
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        },
        generateEmailBody() {
            const dom = HiringCoPilotApp.dom;
            const sidebarText = dom.dashboardSidebar ? dom.dashboardSidebar.innerText : 'N/A';
            const summaryText = dom.summaryCard ? dom.summaryCard.innerText : 'N/A';
            const separator = "\n\n================================\n\n";
            return `Здравствуйте,\n\nНиже представлена краткая сводка по кандидату:\n${separator}CАММАРИ (Боковая панель):\n${sidebarText}${separator}ОБЩИЙ ВЕРДИКТ И ОБОСНОВАНИЕ:\n${summaryText}\n\nПолный отчет приложен к этому письму или доступен по ссылке.\n\nС уважением,\nHiring CoPilot.`;
        },
    },
    events: {
        setupListeners() {
            const dom = HiringCoPilotApp.dom;
            const helpers = HiringCoPilotApp.helpers;
            const render = HiringCoPilotApp.render;

            // Block: Core Controls Listeners
            if (dom.themeSwitcher) dom.themeSwitcher.addEventListener('click', () => render.applyTheme(dom.htmlElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'));
            if (dom.savePdfBtn) dom.savePdfBtn.addEventListener('click', () => window.print());
            
            // Block: Dropdown Menu Listeners
            if (dom.sectionSelectorBtn) dom.sectionSelectorBtn.addEventListener('click', (e) => { e.stopPropagation(); helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown); });
            if (dom.emailBtn) dom.emailBtn.addEventListener('click', (e) => { e.stopPropagation(); helpers.toggleDropdown(dom.emailBtn, dom.emailDropdown); });
            document.addEventListener('click', (e) => {
                const isClickInside = (element, eventTarget) => element && element.contains(eventTarget);
                if (dom.sectionSelectorDropdown?.classList.contains('is-open') && !isClickInside(dom.sectionSelectorBtn.parentElement, e.target)) { helpers.toggleDropdown(dom.sectionSelectorBtn, dom.sectionSelectorDropdown); }
                if (dom.emailDropdown?.classList.contains('is-open') && !isClickInside(dom.emailBtn.parentElement, e.target)) { helpers.toggleDropdown(dom.emailBtn, dom.emailDropdown); }
            });
            if (dom.sendEmailBtn) dom.sendEmailBtn.addEventListener('click', () => {
                const recipient = dom.emailInput.value;
                if (!recipient) { alert('Введите email'); return; }
                const subject = encodeURIComponent(`Отчет по кандидату: ${document.querySelector('[data-element="candidate-name"]').textContent.trim()}`);
                const body = encodeURIComponent(helpers.generateEmailBody());
                window.location.href = `mailto:${recipient}?subject=${subject}&body=${body}`;
            });

            // Block: Markdown Download Listeners
            document.querySelectorAll('#download-task-md-btn, #download-evaluation-md-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const isTask = e.currentTarget.id === 'download-task-md-btn';
                    const contentEl = document.getElementById(isTask ? 'test-assignment-md' : 'evaluation-form-md');
                    const fileName = (isTask ? 'test-assignment' : 'evaluation-criteria') + '.md';
                    let content = contentEl.textContent;
                    if (!isTask) { content = content.replace(/\|/g, ' | ').replace(/---\|/g, '---|'); }
                    helpers.downloadMarkdown(content, fileName);
                });
            });
            if (dom.saveCommentsBtn) dom.saveCommentsBtn.addEventListener('click', () => {
                const content = dom.notesTextarea.value;
                if (content) { helpers.downloadMarkdown(content, 'recruiter-comments.md'); }
            });

            // Block: Utility & Lifecycle Listeners
            if (dom.scrollToTopBtn) {
                window.addEventListener('scroll', () => { dom.scrollToTopBtn.classList.toggle('is-visible', window.scrollY > 300); });
                dom.scrollToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
            }
            if (dom.notesTextarea) {
                dom.notesTextarea.addEventListener('input', () => { localStorage.setItem(HiringCoPilotApp.config.NOTES_STORAGE_KEY, dom.notesTextarea.value); });
            }
            const autoScaleTarget = '[data-element="candidate-header"]';
            window.addEventListener('resize', () => HiringCoPilotApp.helpers.autoScaleFont(autoScaleTarget));
        },
    },

    // ==== 7. INITIALIZATION ====
    init() {
            this.cacheDomElements();
            this.render.applyTheme(localStorage.getItem(this.config.THEME_STORAGE_KEY) || this.config.DEFAULT_THEME);
            const savedNotes = localStorage.getItem(this.config.NOTES_STORAGE_KEY);
            if (this.dom.notesTextarea && savedNotes) { this.dom.notesTextarea.value = savedNotes; }

            this.loadData();
            this.helpers.populateSectionSelector();
            this.events.setupListeners();
            this.render.setReportDate();

            if (this.state.profile.grade === '[...]') {
                // Placeholder logic if needed in the future
            } else {
                this.render.competencyCards(this.state.profile);
                const scores = this.logic.calculateScores(this.state.profile);
                this.render.scores(scores, this.state.profile);
                HiringCoPilotApp.helpers.autoScaleFont('[data-element="candidate-header"]');
            }
    }
};

// Start the application
document.addEventListener('DOMContentLoaded', () => {
    HiringCoPilotApp.init();
});
</script>
<!-- ==== END SCRIPT: MAIN APPLICATION LOGIC ==== -->

<!-- ==== END SECTION: DATA & LOGIC ==== -->
</body>
</html>
